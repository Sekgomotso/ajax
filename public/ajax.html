<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewpoint" content="width=device-width, intitial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="ajax.css">

    <title> Visitor form </title>
</head>
<body>

    <h1 class="heading"> Visitor's form </h1>

    <form action="new_visit" method="POST" id="forms">

        <input type="text" name="visitor_name" placeholder="Visitor name" id="body">
        <br><br>
        <input type="text" name="assistant" placeholder="Assistant" id="body">
        <br><br>
        <input type="text" name="visitors_age" placeholder="Visitor's age" id="body">
        <br><br>
        <input type="text" name="date_of_visit" placeholder="Date of visit" id="body">
        <br><br>
        <input type="text" name="time_of_visit" placeholder="Time of visit" id="body">
        <br><br>
        <input type="text" placeholder="Comments" id="body">
        <br><br>
        <input type="submit" value="Submit">

    </form>

    <br><br>

    <table id="visitors" width = 700px border ="1">

        <h1>Visitor table</h1>

        <thead>
            <tr>
                <th> Id </th>
                <th> Name </th>
                <th> Age </th>
                <th> Date </th>
                <th> Time </th>
                <th> Assistant </th>
                <th> Comments </th>
                <th>&nbsp;</th>
            </tr>
        </thead>
        <tbody>
            <td>1</td>
            <td>Sekgomotso</td>
            <td>24</td>
            <td>24/09/2020</td>
            <td>10:00</td>
            <td>Neo</td>
            <td>Hi</td>
            <td><button>Delete</button></td>
        </tbody>

    </table>

    <script>

        //add event listener
        document.getElementById("forms").addEventListener("submit", addNewVisitor);
        document.getElementById("forms").addEventListener("submit", viewVisitors);

        const addNewVisitor = async (event) => {

            event.preventDefault();

            let forms = document.getElementById("forms").value;
            let body = document.getElementById("body").value;

            try{

                // submit button
                let data = await fetch ('http://localhost:3009/single-page-app', {
                method:"POST",
                headers:{
                    "Content-type":"application/json"
                },
                mode:'cors',

                // change a json file to a string
                body: JSON.stringify({forms: forms, body:body})
            })
            
            } catch (err) {
                console.log(err)
            }
        }
        
        // populate table
        
    </script>

</body>
    
</html>